<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>seqfu stats | SeqFu 2.0</title>
  <meta name="description" content="Extract length statistics from FASTX files">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/main.css">
  <link rel="icon" href="../../assets/img/fusion-icon.svg" type="image/svg+xml">
  <script>
    / Apply saved theme before page renders to avoid flash
    (function() {
      var theme = localStorage.getItem('theme') ||
        (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>
</head>
<body>
  <header class="site-header">
  <div class="header-inner">
    <a href="../../" class="header-logo">
      <img src="../../assets/img/logo-fusion.svg" alt="Fusion" class="logo-img">
      <span class="logo-text">SeqFu 2.0 - the FASTX swiss-army knife</span>
    </a>
    <div class="header-actions">
      <button class="dark-mode-toggle" id="dark-mode-toggle" aria-label="Toggle dark mode">
        <svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
      </button>
    </div>
  </div>
</header>

  <div class="doc-layout">
  <aside class="sidebar" id="sidebar">
    <button class="sidebar-close" id="sidebar-close" aria-label="Close sidebar">&times;</button>
    <nav class="sidebar-nav" aria-label="Documentation navigation">
  <ul class="sidebar-list">
    
      
        
        
        <li class="sidebar-item">
          <a href="../../" class="sidebar-link">SeqFu 2.0</a>
        </li>
      
    
      
        
        
        <li class="sidebar-item">
          <a href="../../get-started/" class="sidebar-link">Get started</a>
        </li>
      
    
      
        
        
        
        
        
        
        <li class="sidebar-category expanded">
          
            <button class="sidebar-category-btn" aria-expanded="true">
              <span>Commands</span>
              <svg class="caret" width="16" height="16" viewBox="0 0 16 16"><path d="M6 4l4 4-4 4" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
            </button>
          
          <ul class="sidebar-subitems">
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/bases/" class="sidebar-link">seqfu bases</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/cat/" class="sidebar-link">seqfu cat</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/check/" class="sidebar-link">seqfu check</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/count/" class="sidebar-link">seqfu count</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/deinterleave/" class="sidebar-link">seqfu deinterleave</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/derep/" class="sidebar-link">seqfu derep</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/grep/" class="sidebar-link">seqfu grep</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/head/" class="sidebar-link">seqfu head</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/interleave/" class="sidebar-link">seqfu interleave</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/lanes/" class="sidebar-link">seqfu lanes</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/less/" class="sidebar-link">seqfu less</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/list/" class="sidebar-link">seqfu list</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/merge/" class="sidebar-link">seqfu merge</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/metadata/" class="sidebar-link">seqfu metadata</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/qual/" class="sidebar-link">seqfu qual</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/rc/" class="sidebar-link">seqfu rc</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/rotate/" class="sidebar-link">seqfu rotate</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/sort/" class="sidebar-link">seqfu sort</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item active">
                  <a href="../../commands/stats/" class="sidebar-link active">seqfu stats</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/tabulate/" class="sidebar-link">seqfu tabulate</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/tail/" class="sidebar-link">seqfu tail</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/tofasta/" class="sidebar-link">seqfu tofasta</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/trim/" class="sidebar-link">seqfu trim</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/view/" class="sidebar-link">seqfu view</a>
                </li>
              
            
          </ul>
        </li>
      
    
      
        
        
        <li class="sidebar-item">
          <a href="../../background/" class="sidebar-link">Background</a>
        </li>
      
    
      
        
        
        <li class="sidebar-item">
          <a href="../../reference/" class="sidebar-link">Citation</a>
        </li>
      
    
      
        
        
        
        
        
        
        <li class="sidebar-category">
          
            <button class="sidebar-category-btn" aria-expanded="false">
              <span>Tutorials</span>
              <svg class="caret" width="16" height="16" viewBox="0 0 16 16"><path d="M6 4l4 4-4 4" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
            </button>
          
          <ul class="sidebar-subitems">
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../tutorial/first/" class="sidebar-link">General</a>
                </li>
              
            
          </ul>
        </li>
      
    
      
        
        
        <li class="sidebar-item">
          <a href="../../faq/" class="sidebar-link">FAQ</a>
        </li>
      
    
  </ul>
</nav>

  </aside>
  <main class="doc-main">
    <div class="doc-content">
      

<nav class="breadcrumbs" aria-label="Breadcrumb">
  <ol class="breadcrumb-list">
    <li class="breadcrumb-item">
      <a href="../../">SeqFu 2.0</a>
    </li>
    
    
      
    
      
        
        
          
          <li class="breadcrumb-item">
            <a href="../../commands/">Commands</a>
          </li>
        
      
    
      
        
        
          <li class="breadcrumb-item current" aria-current="page">
            seqfu stats
          </li>
        
      
    
  </ol>
</nav>


      <article class="markdown-body">
        <h1>seqfu stats</h1>
        <p><em>stats</em>  is one of the core subprograms of <em>SeqFu</em>.</p>

<pre><code class="language-note">Version prior to v1.22.1 were calculatin auN incorrectly
</code></pre>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Usage: stats [options] [&lt;inputfile&gt; ...]

Options:
  -a, --abs-path         Print absolute paths
  -b, --basename         Print only filenames
  -n, --nice             Print nice terminal table
  -j, --json             Print json (EXPERIMENTAL)
  -s, --sort-by KEY      Sort by KEY from: filename, counts, n50, tot, avg, min, max
                         descending for values, ascending for filenames [default: none]
  -r, --reverse          Reverse sort order
  -t, --thousands        Add thousands separator (only tabbed/nice output)
  --csv                  Separate output by commas instead of tabs
  --gc                   Also print %GC
  --multiqc FILE         Saves a MultiQC report to FILE (suggested: name_mqc.txt)
  --precision INT        Number of decimal places to round to [default: 2]
  --noheader             Do not print header
  -v, --verbose          Verbose output
  -h, --help             Show this help
</code></pre></div></div>

<h3 id="sorting">Sorting</h3>

<pre><code class="language-note">Sorting added in SeqFu 1.11. 
</code></pre>

<p>To sort by filename (ascending alphabetical order) add <code class="language-plaintext highlighter-rouge">--sort filename</code>.
Numerical values are sorted from the largest (descending), supported values are:</p>
<ul>
  <li><em>n50</em>, <em>n75</em> or <em>N90</em></li>
  <li><em>count</em> or <em>counts</em> (number of reads)</li>
  <li><em>sum</em> or <em>tot</em> (total bases)</li>
  <li><em>min</em> or <em>minimum</em> (minimum length)</li>
  <li><em>max</em> or <em>maximum</em> (maximum length)</li>
  <li><em>avg</em> or <em>mean</em> (average length)</li>
  <li><em>aun</em> (area under the Nx curve)</li>
</ul>

<p><strong>NOTE</strong> Specifying an invalid key will result in unsorted results with a warning,
but in future releases this might throw an error.</p>

<h3 id="example-output">Example output</h3>

<p>Output is a TSV text with three columns (or CSV using  <code class="language-plaintext highlighter-rouge">--csv</code>):</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>File,#Seq,Sum,Avg,N50,N75,N90,Min,Max
data/filt.fa.gz,78730,24299931,308.6,316,316,220,180,485
</code></pre></div></div>

<h3 id="screen-friendly-output">Screen friendly output</h3>

<p>When using <code class="language-plaintext highlighter-rouge">-n</code> (<code class="language-plaintext highlighter-rouge">--nice</code>) output:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>seqfu stats data/filt.fa.gz  -n
┌─────────────────┬───────┬──────────┬───────┬─────┬─────┬─────┬───────┬─────┬─────┐
│ File            │ #Seq  │ Total bp │ Avg   │ N50 │ N75 │ N90 │ auN   │ Min │ Max │
├─────────────────┼───────┼──────────┼───────┼─────┼─────┼─────┼───────┼─────┼─────┤
│ data/filt.fa.gz │ 78730 │ 24299931 │ 308.6 │ 316 │ 316 │ 220 │ 0.385 │ 180 │ 485 │
└─────────────────┴───────┴──────────┴───────┴─────┴─────┴─────┴───────┴─────┴─────┘
</code></pre></div></div>

<h2 id="multiqc-output">MultiQC output</h2>

<p>Using the  <code class="language-plaintext highlighter-rouge">--multiqc OUTPUTFILE</code> option it’s possible to save a MultiQC compatible file (we recommend to use the <em>projectname_mqc.tsv</em> filename format).
After coolecting all the MultiQC files in a directory, using <code class="language-plaintext highlighter-rouge">multiqc -f .</code> will generate the MultiQC report. 
MultiQC itself can be installed via Bioconda with <code class="language-plaintext highlighter-rouge">conda install -y -c bioconda multiqc</code>.</p>

<p>To understand how to use MultiQC, if you never did so, check their excellent <a href="https://multiqc.info">documentation</a>.</p>

<h2 id="legacy">Legacy</h2>

<p>The pre 1.11 version of the statistics has been made available via <code class="language-plaintext highlighter-rouge">seqfu oldstats</code>.
There are no breaking changes at the moment, and an expanded set of tests ensures
the compatibility not only of the metrics (unchanged) but also of the output (now
supporting sorting options).</p>

<h2 id="benchmark">Benchmark</h2>

<p>A similar functionality is provided by <code class="language-plaintext highlighter-rouge">SeqKit</code>, so we compared the performance of 
SeqFu with 
<a href="https://bioinf.shenwei.me/seqkit/">SeqKit</a> and 
<a href="https://metacpan.org/pod/release/PROCH/Proch-N50-1.3.0/bin/n50">n50</a>, 
both available from bioconda. 
We used a Linux Virtual Machine running Ubuntu 18.04, with 8 cores and 64 Gb of RAM for the test,
with Miniconda (4.9.2) to install the required tools.</p>

<p>:warning: SeqKit, by default, omits N50 calculation, that is a core feature (always enabled) in SeqFu.
The correct comparison is thus between <code class="language-plaintext highlighter-rouge">seqfu stats</code> and <code class="language-plaintext highlighter-rouge">seqkit stats --all</code>.</p>

<p>Speed evaluate with 
<a href="https://github.com/sharkdp/hyperfine">hyperfine</a>, 
peak memory usage with this 
<a href="https://gist.github.com/MattForshaw/86b82b6c09bdbfce5ff5ee570e8a8bef">bash script</a>.</p>

<p>As dataset we used the Human Genome (see <a href="https://bioinf.shenwei.me/seqkit/benchmark/">this benchmark page</a>),
which contains few large sequences, and the reference genome of the gastrointestinal tract, which is composed by many
short sequences instead.</p>

<p>The test can be replicated with these commands:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Download tools (can be done in a new environment)</span>
conda <span class="nb">install</span> <span class="nt">-c</span> conda-forge <span class="nt">-c</span> bioconda hyperfine <span class="nv">n50</span><span class="o">=</span>1.3.0 <span class="nv">seqkit</span><span class="o">=</span>0.16.0 <span class="nv">seqfu</span><span class="o">=</span>0.9.6
 
<span class="c"># Download datasets: many short sequences and few large sequences </span>
wget http://downloads.hmpdacc.org/data/reference_genomes/body_sites/Gastrointestinal_tract.nuc.fsa
wget ftp://ftp.ensembl.org/pub/release-84/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.gz

<span class="c"># Compare execution times</span>
<span class="nv">FILE1</span><span class="o">=</span>Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.gz
<span class="nv">FILE2</span><span class="o">=</span>Gastrointestinal_tract.nuc.fsa

<span class="k">for </span>FILE <span class="k">in</span> <span class="nv">$FILE1</span> <span class="nv">$FILE2</span><span class="p">;</span> <span class="k">do
  </span>hyperfine <span class="nt">--export-markdown</span> stat_<span class="si">$(</span><span class="nb">basename</span> <span class="nv">$FILE</span> | <span class="nb">cut</span> <span class="nt">-f1</span> <span class="nt">-d</span>.<span class="si">)</span>.md <span class="nt">--warmup</span> 1 <span class="nt">--min-runs</span> 3 <span class="se">\</span>
    <span class="s2">"seqfu stats </span><span class="nv">$FILE</span><span class="s2">"</span> <span class="se">\</span>
    <span class="s2">"seqkit stats </span><span class="nv">$FILE</span><span class="s2">"</span> <span class="se">\</span>
    <span class="s2">"seqkit stats --all </span><span class="nv">$FILE</span><span class="s2">"</span> <span class="se">\</span>
    <span class="s2">"n50 -x </span><span class="nv">$FILE</span><span class="s2">"</span> 
<span class="k">done</span>
</code></pre></div></div>

<p>The result, for the <strong>Human Genome</strong> (few large sequences), has been:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Command</th>
      <th style="text-align: right">Mean [s]</th>
      <th style="text-align: right">Min [s]</th>
      <th style="text-align: right">Max [s]</th>
      <th style="text-align: right">Relative</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">seqfu stats $FILE</code></td>
      <td style="text-align: right">27.420 ± 0.349</td>
      <td style="text-align: right">27.090</td>
      <td style="text-align: right">27.785</td>
      <td style="text-align: right">1.00</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">seqkit stats $FILE</code>  :warning:</td>
      <td style="text-align: right">116.693 ± 0.236</td>
      <td style="text-align: right">116.512</td>
      <td style="text-align: right">116.960</td>
      <td style="text-align: right">4.26 ± 0.05</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">seqkit stats --all $FILE</code></td>
      <td style="text-align: right">120.435 ± 0.434</td>
      <td style="text-align: right">120.054</td>
      <td style="text-align: right">120.907</td>
      <td style="text-align: right">4.39 ± 0.06</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">n50 -x $FILE</code></td>
      <td style="text-align: right">34.888 ± 0.628</td>
      <td style="text-align: right">34.167</td>
      <td style="text-align: right">35.316</td>
      <td style="text-align: right">1.27 ± 0.03</td>
    </tr>
  </tbody>
</table>

<p>For the <strong>Gastrointestinal reference genomes</strong> (many short sequences):</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Command</th>
      <th style="text-align: right">Mean [s]</th>
      <th style="text-align: right">Min [s]</th>
      <th style="text-align: right">Max [s]</th>
      <th style="text-align: right">Relative</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">seqfu stats $FILE</code></td>
      <td style="text-align: right">6.885 ± 0.307</td>
      <td style="text-align: right">6.602</td>
      <td style="text-align: right">7.211</td>
      <td style="text-align: right">1.82 ± 0.09</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">seqkit stats $FILE</code> :warning:</td>
      <td style="text-align: right">3.793 ± 0.082</td>
      <td style="text-align: right">3.699</td>
      <td style="text-align: right">3.854</td>
      <td style="text-align: right">1.00</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">seqkit stats --all $FILE</code></td>
      <td style="text-align: right">7.667 ± 0.081</td>
      <td style="text-align: right">7.583</td>
      <td style="text-align: right">7.746</td>
      <td style="text-align: right">2.02 ± 0.05</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">n50 -x $FILE</code></td>
      <td style="text-align: right">76.377 ± 1.990</td>
      <td style="text-align: right">74.891</td>
      <td style="text-align: right">78.638</td>
      <td style="text-align: right">20.14 ± 0.68</td>
    </tr>
  </tbody>
</table>

<h2 id="screenshot">Screenshot</h2>

<p><img src="../../assets/img/screenshot-stats.svg" alt="Screenshot of &quot;seqfu stats&quot;" title="SeqFu stats" /></p>

      </article>
      














<nav class="pagination" aria-label="Page navigation">
  
    <a href="../../commands/sort/" class="pagination-link pagination-prev">
      <span class="pagination-label">Previous</span>
      <span class="pagination-title">seqfu sort</span>
    </a>
  
  
    <a href="../../commands/tabulate/" class="pagination-link pagination-next">
      <span class="pagination-label">Next</span>
      <span class="pagination-title">seqfu tabulate</span>
    </a>
  
</nav>


    </div>
    <aside class="toc-sidebar">
      




<nav class="toc" aria-label="Table of contents">
  <h4 class="toc-title">On this page</h4>
  <ul class="toc-list">
    
      
      
      
      
      <li class="toc-item toc-level-3">
        <a href="#sorting" class="toc-link">Sorting</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-3">
        <a href="#example-output" class="toc-link">Example output</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-3">
        <a href="#screen-friendly-output" class="toc-link">Screen friendly output</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-2">
        <a href="#multiqc-output" class="toc-link">MultiQC output</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-2">
        <a href="#legacy" class="toc-link">Legacy</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-2">
        <a href="#benchmark" class="toc-link">Benchmark</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-2">
        <a href="#screenshot" class="toc-link">Screenshot</a>
      </li>
    
  </ul>
</nav>


    </aside>
  </main>
</div>
<button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <line x1="3" y1="6" x2="21" y2="6"></line>
    <line x1="3" y1="12" x2="21" y2="12"></line>
    <line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</button>

  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-links">
      <a href="https://github.com/telatin/seqfu2"   target="_blank" rel="noopener">GitHub Repository</a>
      <a href="https://www.quadram.ac.uk/"  target="_blank" rel="noopener">Quadram Institute Bioscience</a>
      <a href="https://telatin.github.io"  target="_blank" rel="noopener">Andrea Telatin</a>
    </div>
    <div class="footer-bottom">
      <p class="footer-copyright">&copy; 2026 Quadram Institute Bioscience. All rights reserved.</p>
      <div class="footer-legal">
        <a href="">Policy</a>
      </div>
    </div>
  </div>
</footer>

  <script src="../../assets/js/dark-mode.js"></script>
  <script src="../../assets/js/sidebar.js"></script>
  <script src="../../assets/js/toc.js"></script>
</body>
</html>
