<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>seqfu tofasta | SeqFu 2.0</title>
  <meta name="description" content="Convert various sequence formats to FASTA">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/main.css">
  <link rel="icon" href="../../assets/img/fusion-icon.svg" type="image/svg+xml">
  <script>
    / Apply saved theme before page renders to avoid flash
    (function() {
      var theme = localStorage.getItem('theme') ||
        (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>
</head>
<body>
  <header class="site-header">
  <div class="header-inner">
    <a href="../../" class="header-logo">
      <img src="../../assets/img/logo-fusion.svg" alt="Fusion" class="logo-img">
      <span class="logo-text">SeqFu 2.0 - the FASTX swiss-army knife</span>
    </a>
    <div class="header-actions">
      <button class="dark-mode-toggle" id="dark-mode-toggle" aria-label="Toggle dark mode">
        <svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
      </button>
    </div>
  </div>
</header>

  <div class="doc-layout">
  <aside class="sidebar" id="sidebar">
    <button class="sidebar-close" id="sidebar-close" aria-label="Close sidebar">&times;</button>
    <nav class="sidebar-nav" aria-label="Documentation navigation">
  <ul class="sidebar-list">
    
      
        
        
        <li class="sidebar-item">
          <a href="../../" class="sidebar-link">SeqFu 2.0</a>
        </li>
      
    
      
        
        
        <li class="sidebar-item">
          <a href="../../get-started/" class="sidebar-link">Get started</a>
        </li>
      
    
      
        
        
        
        
        
        
        <li class="sidebar-category expanded">
          
            <button class="sidebar-category-btn" aria-expanded="true">
              <span>Commands</span>
              <svg class="caret" width="16" height="16" viewBox="0 0 16 16"><path d="M6 4l4 4-4 4" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
            </button>
          
          <ul class="sidebar-subitems">
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/bases/" class="sidebar-link">seqfu bases</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/cat/" class="sidebar-link">seqfu cat</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/check/" class="sidebar-link">seqfu check</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/count/" class="sidebar-link">seqfu count</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/deinterleave/" class="sidebar-link">seqfu deinterleave</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/derep/" class="sidebar-link">seqfu derep</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/grep/" class="sidebar-link">seqfu grep</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/head/" class="sidebar-link">seqfu head</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/interleave/" class="sidebar-link">seqfu interleave</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/lanes/" class="sidebar-link">seqfu lanes</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/less/" class="sidebar-link">seqfu less</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/list/" class="sidebar-link">seqfu list</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/merge/" class="sidebar-link">seqfu merge</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/metadata/" class="sidebar-link">seqfu metadata</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/qual/" class="sidebar-link">seqfu qual</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/rc/" class="sidebar-link">seqfu rc</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/rotate/" class="sidebar-link">seqfu rotate</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/sort/" class="sidebar-link">seqfu sort</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/stats/" class="sidebar-link">seqfu stats</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/tabulate/" class="sidebar-link">seqfu tabulate</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/tail/" class="sidebar-link">seqfu tail</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item active">
                  <a href="../../commands/tofasta/" class="sidebar-link active">seqfu tofasta</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/trim/" class="sidebar-link">seqfu trim</a>
                </li>
              
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../commands/view/" class="sidebar-link">seqfu view</a>
                </li>
              
            
          </ul>
        </li>
      
    
      
        
        
        <li class="sidebar-item">
          <a href="../../background/" class="sidebar-link">Background</a>
        </li>
      
    
      
        
        
        <li class="sidebar-item">
          <a href="../../reference/" class="sidebar-link">Citation</a>
        </li>
      
    
      
        
        
        
        
        
        
        <li class="sidebar-category">
          
            <button class="sidebar-category-btn" aria-expanded="false">
              <span>Tutorials</span>
              <svg class="caret" width="16" height="16" viewBox="0 0 16 16"><path d="M6 4l4 4-4 4" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
            </button>
          
          <ul class="sidebar-subitems">
            
              
                
                
                <li class="sidebar-item">
                  <a href="../../tutorial/first/" class="sidebar-link">General</a>
                </li>
              
            
          </ul>
        </li>
      
    
      
        
        
        <li class="sidebar-item">
          <a href="../../faq/" class="sidebar-link">FAQ</a>
        </li>
      
    
  </ul>
</nav>

  </aside>
  <main class="doc-main">
    <div class="doc-content">
      

<nav class="breadcrumbs" aria-label="Breadcrumb">
  <ol class="breadcrumb-list">
    <li class="breadcrumb-item">
      <a href="../../">SeqFu 2.0</a>
    </li>
    
    
      
    
      
        
        
          
          <li class="breadcrumb-item">
            <a href="../../commands/">Commands</a>
          </li>
        
      
    
      
        
        
          <li class="breadcrumb-item current" aria-current="page">
            seqfu tofasta
          </li>
        
      
    
  </ol>
</nav>


      <article class="markdown-body">
        <h1>seqfu tofasta</h1>
        <p>Converts various sequence file formats to FASTA format.</p>

<pre><code class="language-note">Introduced in SeqFu 1.23.0
</code></pre>

<p>A versatile format converter supporting multiple bioinformatics file formats including
sequence alignments, genome annotations, and assembly graphs. The tool automatically
detects the input format and converts sequences to standard FASTA format.</p>

<p>Replicates the approach of <a href="https://github.com/tseeman/any2fasta">any2fasta</a>, but it’s faster.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Usage: tofasta [options] &lt;inputfile&gt;...

Convert various sequence formats to FASTA format.

Options:
  -n, --replace-iupac    Replace non-IUPAC characters with 'N'
  -l, --to-lowercase     Convert sequences to lowercase
  -u, --to-uppercase     Convert sequences to uppercase
  -o, --output FILE      Write output to FILE (default: stdout)
                         Note: checks for duplicate IDs across all files
  -v, --verbose          Print progress information to stderr
  -h, --help             Show this help
</code></pre></div></div>

<h2 id="supported-formats">Supported Formats</h2>

<p><code class="language-plaintext highlighter-rouge">seqfu tofasta</code> automatically detects and converts the following formats:</p>

<table>
  <thead>
    <tr>
      <th>Format</th>
      <th>Description</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>FASTA</td>
      <td>Standard FASTA format</td>
      <td>Pass-through with optional transformations</td>
    </tr>
    <tr>
      <td>FASTQ</td>
      <td>Sanger, Illumina, Solexa</td>
      <td>Quality scores are discarded</td>
    </tr>
    <tr>
      <td>GenBank</td>
      <td>NCBI GenBank flat file</td>
      <td>Extracts sequences from ORIGIN section</td>
    </tr>
    <tr>
      <td>EMBL</td>
      <td>EMBL-Bank format</td>
      <td>Extracts sequences from SQ section</td>
    </tr>
    <tr>
      <td>GFF</td>
      <td>Generic Feature Format</td>
      <td>Extracts sequences after <code class="language-plaintext highlighter-rouge">##FASTA</code> directive</td>
    </tr>
    <tr>
      <td>GFA</td>
      <td>Graphical Fragment Assembly</td>
      <td>Extracts sequences from S (segment) lines</td>
    </tr>
    <tr>
      <td>Clustal</td>
      <td>Clustal W alignment</td>
      <td>Preserves gaps in sequences</td>
    </tr>
    <tr>
      <td>Stockholm</td>
      <td>Stockholm alignment</td>
      <td>Converts ‘.’ gaps to ‘-‘</td>
    </tr>
  </tbody>
</table>

<h2 id="options">Options</h2>

<p><strong><code class="language-plaintext highlighter-rouge">-n, --replace-iupac</code></strong>
Replaces non-standard IUPAC characters with ‘N’. Standard IUPAC codes (A, T, G, C, N)
are preserved, while ambiguous codes (R, Y, W, S, K, M, etc.) are replaced with ‘N’.</p>

<p><strong><code class="language-plaintext highlighter-rouge">-l, --to-lowercase</code></strong>
Converts all sequence characters to lowercase. Useful for soft-masking or
compatibility with tools that expect lowercase input.</p>

<p><strong><code class="language-plaintext highlighter-rouge">-u, --to-uppercase</code></strong>
Converts all sequence characters to uppercase. Takes precedence over <code class="language-plaintext highlighter-rouge">-l</code> if both
are specified.</p>

<p><strong><code class="language-plaintext highlighter-rouge">-o, --output FILE</code></strong>
Writes all sequences to a single output file instead of stdout. When using this option,
the tool performs duplicate ID checking across all input files and will exit with an
error if duplicate sequence IDs are found.</p>

<p><strong><code class="language-plaintext highlighter-rouge">-v, --verbose</code></strong>
Prints progress information to stder</p>

<h2 id="examples">Examples</h2>

<h3 id="basic-format-conversion">Basic Format Conversion</h3>

<p>Convert a GenBank file to FASTA:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>seqfu tofasta genome.gbk <span class="o">&gt;</span> genome.fasta
</code></pre></div></div>

<p>Convert a FASTQ file (quality scores are discarded):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>seqfu tofasta reads.fastq.gz <span class="o">&gt;</span> reads.fasta
</code></pre></div></div>

<h3 id="multiple-files">Multiple Files</h3>

<p>Process multiple files and combine into one FASTA file:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>seqfu tofasta <span class="nt">-o</span> combined.fasta file1.gbk file2.gff file3.fastq.gz
</code></pre></div></div>

<p>Replace ambiguous IUPAC codes with N:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>seqfu tofasta <span class="nt">-n</span> <span class="nt">-u</span> sequences.fasta <span class="o">&gt;</span> clean.fasta
</code></pre></div></div>

<h3 id="input-handling">Input Handling</h3>

<ul>
  <li><strong>Gzip Support</strong>: All input files can be gzip-compressed (<code class="language-plaintext highlighter-rouge">.gz</code> extension)</li>
  <li><strong>No STDIN</strong>: Currently, <code class="language-plaintext highlighter-rouge">tofasta</code> requires file arguments and does not support reading from standard input</li>
  <li><strong>Format Detection</strong>: File format is automatically detected from content, not file extension</li>
  <li><strong>Error Handling</strong>: The tool is strict and will exit with an error on unknown or malformed formats</li>
</ul>

<h3 id="duplicate-id-detection">Duplicate ID Detection</h3>

<p>When using <code class="language-plaintext highlighter-rouge">-o/--output</code>, the tool checks for duplicate sequence IDs across all input files:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># This will fail if seq1.gbk and seq2.gbk contain sequences with the same ID</span>
seqfu tofasta <span class="nt">-o</span> combined.fasta seq1.gbk seq2.gbk
</code></pre></div></div>

<p>Error message example:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERROR: Duplicate sequence ID found: NZ_12345
  First occurrence in a previous file
  Second occurrence in: seq2.gbk
</code></pre></div></div>

<h3 id="format-specific-behavior">Format-Specific Behavior</h3>

<p><strong>GenBank/EMBL</strong>:</p>
<ul>
  <li>Extracts accession number as sequence ID</li>
  <li>Extracts sequence from ORIGIN/SQ section</li>
  <li>Handles multiple records in a single file</li>
</ul>

<p><strong>GFF</strong>:</p>
<ul>
  <li>Only processes sequences after <code class="language-plaintext highlighter-rouge">##FASTA</code> directive</li>
  <li>Ignores feature annotations</li>
  <li>Preserves sequence IDs from FASTA headers</li>
</ul>

<p><strong>Clustal/Stockholm</strong>:</p>
<ul>
  <li>Preserves alignment gaps in output</li>
  <li>Concatenates sequence fragments if alignment spans multiple blocks</li>
  <li>Stockholm ‘.’ gaps are converted to ‘-‘</li>
</ul>

<p><strong>GFA</strong>:</p>
<ul>
  <li>Only processes S (segment) lines</li>
  <li>Uses segment name as sequence ID</li>
  <li>Ignores paths, links, and other graph elements</li>
</ul>


      </article>
      














<nav class="pagination" aria-label="Page navigation">
  
    <a href="../../commands/tail/" class="pagination-link pagination-prev">
      <span class="pagination-label">Previous</span>
      <span class="pagination-title">seqfu tail</span>
    </a>
  
  
    <a href="../../commands/trim/" class="pagination-link pagination-next">
      <span class="pagination-label">Next</span>
      <span class="pagination-title">seqfu trim</span>
    </a>
  
</nav>


    </div>
    <aside class="toc-sidebar">
      




<nav class="toc" aria-label="Table of contents">
  <h4 class="toc-title">On this page</h4>
  <ul class="toc-list">
    
      
      
      
      
      <li class="toc-item toc-level-2">
        <a href="#supported-formats" class="toc-link">Supported Formats</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-2">
        <a href="#options" class="toc-link">Options</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-2">
        <a href="#examples" class="toc-link">Examples</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-3">
        <a href="#basic-format-conversion" class="toc-link">Basic Format Conversion</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-3">
        <a href="#multiple-files" class="toc-link">Multiple Files</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-3">
        <a href="#input-handling" class="toc-link">Input Handling</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-3">
        <a href="#duplicate-id-detection" class="toc-link">Duplicate ID Detection</a>
      </li>
    
      
      
      
      
      <li class="toc-item toc-level-3">
        <a href="#format-specific-behavior" class="toc-link">Format-Specific Behavior</a>
      </li>
    
  </ul>
</nav>


    </aside>
  </main>
</div>
<button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <line x1="3" y1="6" x2="21" y2="6"></line>
    <line x1="3" y1="12" x2="21" y2="12"></line>
    <line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</button>

  <footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-links">
      <a href="https://github.com/telatin/seqfu2"   target="_blank" rel="noopener">GitHub Repository</a>
      <a href="https://www.quadram.ac.uk/"  target="_blank" rel="noopener">Quadram Institute Bioscience</a>
      <a href="https://telatin.github.io"  target="_blank" rel="noopener">Andrea Telatin</a>
    </div>
    <div class="footer-bottom">
      <p class="footer-copyright">&copy; 2026 Quadram Institute Bioscience. All rights reserved.</p>
      <div class="footer-legal">
        <a href="">Policy</a>
      </div>
    </div>
  </div>
</footer>

  <script src="../../assets/js/dark-mode.js"></script>
  <script src="../../assets/js/sidebar.js"></script>
  <script src="../../assets/js/toc.js"></script>
</body>
</html>
